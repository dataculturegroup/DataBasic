{% extends 'tool_base.html' %}
{% from 'macros.html' import render_forms, hover_tooltip, shareable with context %}

{% block title %}{{ _('ConnectTheDots: ') }}{{ results['filename'] }}{% endblock %}

{% block custom_css %}
  <link href="{{ url_for('static', filename='css/connectthedots-results.scss.css') }}" rel="stylesheet" type="text/css">
{% endblock %}

{% block results_scripts %}
  <script type="text/javascript">
    var data = JSON.parse({{ results['json'] | tojson | safe }});
    var filename = '{{ results["filename"] }}';
  </script>
  {% assets "js_ctd" %}<script type="text/javascript" src="{{ ASSET_URL }}"></script>{% endassets %}
{% endblock %}

{% block nav %}
  {% include 'tool_header.html' %}
{% endblock %}

{% block body %}
<div class="tool" role="main">
  <div class="container">
    {% if has_multiple_sheets %}
      <h4 class="text-center" role="alert">Warning: The file you uploaded had multiple sheets, but we only used the first sheet.</h4>
    {% endif %}
    <div class="row text-center">
      <div class="col-md-12">
        {{ tool_logo() }}
        <h2 id="results-title" role="banner">
          {{ results['filename'] }}
          {{ shareable() }}
        </h2>
      </div>
      <div class="col-md-8 col-md-offset-2">
        <p class="summary">{{ _('This network graph contains %(node_count)s %(nodes)s and %(edge_count)s %(edges)s. Fusce dapibus, tellus ac cursus commodo, tortor mauris condimentum nibh, ut fermentum massa justo sit amet risus.',
            node_count=results['nodes'],
            edge_count=results['edges'],
            nodes=hover_tooltip(_('nodes'), 'nodes', _('The &quot;dots&quot; in the network - the central organizing thing that is connected to others.')),
            edges=hover_tooltip(_('edges'), 'edges', _('A connection between one node and another node.'))
          ) }}</p>

        {{ what_next_anchor() }}
      </div>
    </div>

    <div class="row">
      <div class="col-md-7">
        <div class="ctd-container">
          <div class="ctd-progress" role="progressbar" aria-hidden="true"></div>
          <div class="ctd-download dropdown">
            <button type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
              Download
              <span class="glyphicon glyphicon-download" aria-hidden="true"></span>
            </button>
            <ul class="dropdown-menu">
              <li><a class="btn-download--png"><strong>PNG</strong> - for the web</a></li>
              <li><a class="btn-download--svg"><strong>SVG</strong> - for printing or editing</a></li>
              <li><a class="btn-download--gexf"><strong>GEXF</strong> - for analysis</a></li>
              <li role="separator" class="divider" aria-hidden="true"></li>
              <li><a class="btn-download--table">Download the <strong>table</strong></a></li>
            </ul>
          </div>
          <div class="ctd-tooltip tooltip top" role="tooltip" aria-hidden="true">
            <div class="tooltip-arrow"></div>
            <div class="tooltip-inner"></div>
          </div>
          <svg class="ctd-graph"></svg>
          <div class="ctd-meta" role="list" aria-label="Graph metadata">
            <div class="row text-center">
              <div class="col-sm-4">
                <h4 class="ctd-meta--name" role="listitem">{{ _('%(density_score)s',
                  density_score=hover_tooltip(_('density score'), 'density score', _('Measures how interconnected the whole network is. If every node were connected to every other node, the density would be 1.'))
                  ) }}</h4>
                <h3 class="ctd-meta--value" role="listitem">{{ results['density'] | round(3) }}</h3>
                <p class="ctd-meta--summary">Etiam porta sem malesuada magna mollis euismod.</p>
              </div>
              <div class="col-sm-4">
                <h4 class="ctd-meta--name" role="listitem">{{ _('%(clustering_score)s',
                  clustering_score=hover_tooltip(_('clustering score'), 'clustering score', _('Summarizes how much the network diagram is broken into cliques.  A score close to 1 means it is like high school (i.e. lots of cliques).'))
                  ) }}</h4>
                <h3 class="ctd-meta--value" role="listitem">{{ results['clustering'] | round(3) }}</h3>
                <p class="ctd-meta--summary">Aenean eu leo quam, pellentesque ornare sem lacinia vestibulum.</p>
              </div>
              <div class="col-sm-4">
                <h4 class="ctd-meta--name" role="listitem">{{ _('%(most_central_node)s',
                  most_central_node=hover_tooltip(_('most central node'), 'centrality', _('Scores how much of a &quot;connector&quot; each node is.  A high score means lots of nodes can go through one to quickly connect to other nodes.'))
                  ) }}</h4>
                <h3 class="ctd-meta--value" role="listitem">
                  {% set kevin_bacon = results['table'][0]['id'] %}
                  {% if kevin_bacon is number and kevin_bacon is equalto kevin_bacon | round %}
                    {{ kevin_bacon | int }}
                  {% else %}
                    {{ kevin_bacon }}
                  {% endif %}
                </h3>
                <p class="ctd-meta--summary">Praesent commodo cursus magna, vel scelerisque et.</p>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="col-md-5">
        <table class="ctd-table table table-compact table-striped" aria-label="Top 40 nodes by degree">
          <thead>
            <tr>
              <th data-column="id">
                {{ _('%(node)s',
                node=hover_tooltip(_('Node'), 'node', _('The &quot;dots&quot; in the network - the central organizing thing that is connected to others.'), 'bottom', 'hover')
                ) }}
              </th>
              <th class="ctd-sort--desc" data-column="degree">
                {{ _('%(degree)s',
                degree=hover_tooltip(_('Degree'), 'degree', _('The immediate number of connections a node has.'), 'bottom', 'hover')
                ) }}
              </th>
              <th data-column="centrality">
                {{ _('%(centrality)s',
                centrality=hover_tooltip(_('Centrality'), 'centrality', _('Scores how much of a &quot;connector&quot; each node is.  A high score means lots of nodes can go through one to quickly connect to other nodes.'), 'bottom', 'hover')
                ) }}
              </th>
            </tr>
          </thead>
        </table>
      </div>
    </div>
  </div>
  <div class="container-fluid">
    <div id="what-next" class="row text-center">
      <div class="col-md-8 col-md-offset-2">
        {{ what_next(_('Cras mattis consectetur purus sit amet fermentum. Vivamus sagittis lacus vel augue laoreet rutrum faucibus dolor auctor. Donec id elit non mi porta gravida at eget metus. Maecenas faucibus mollis interdum.')) }}
      </div>
    </div>
  </div>
</div>
{% endblock %}